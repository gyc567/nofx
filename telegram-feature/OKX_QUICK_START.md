# OKX API 快速入门指南

## 🚀 5分钟快速开始

### 第1步: 获取API凭证 (2分钟)

1. 打开浏览器，访问 https://www.okx.com/account/my-api
2. 登录你的OKX账户
3. 点击 **"创建V5 API Key"**
4. 填写以下信息：
   - API名称: `Monnaire Trading Agent`
   - 密码短语: `设置一个容易记住的口令`
5. **选择权限** (重要❗):
   - ✅ 读取
   - ✅ 交易
   - ❌ 提现 (安全考虑，不勾选)
6. 点击 **"创建"**
7. **记录以下信息** (只显示一次⚠️):
   - API Key: `ab12cd34...`
   - Secret Key: `78cd90ef...`
   - Passphrase: `你设置的口令`

### 第2步: 更新配置文件 (1分钟)

编辑 `.env.local` 文件:

```bash
# 找到这些行
OKX_API_KEY=your_api_key_here
OKX_SECRET_KEY=your_secret_key_here
OKX_PASSPHASE=your_passphrase_here

# 替换为真实值
OKX_API_KEY=你的真实API密钥
OKX_SECRET_KEY=你的真实Secret密钥
OKX_PASSPHASE=你的真实Passphrase
```

### 第3步: 运行测试 (2分钟)

```bash
# 运行完整测试
go run test_okx_full.go
```

### 第4步: 验证结果

看到以下输出表示成功:

```
╔═══════════════════════════════════════════════════╗
║              🎉 所有测试完成 🎉                 ║
╚═══════════════════════════════════════════════════╝
```

所有4个测试项都显示 **✅** :

```
🧪 测试1: 获取账户余额
  ✅ 成功获取余额！

🧪 测试2: 获取持仓信息
  ✅ 成功获取持仓信息！

🧪 测试3: 获取账户配置
  ✅ 成功获取账户配置！

🧪 测试4: 获取交易产品信息
  ✅ 成功获取交易产品信息！
```

---

## ❌ 常见错误与解决

### 错误: "Invalid OK-ACCESS-KEY"

**原因**: API凭证错误
**解决**:
```bash
# 1. 重新检查.env.local中的凭证是否正确
cat .env.local | grep OKX

# 2. 确保没有多余的空格或引号
OKX_API_KEY=正确格式←这里没有引号
```

### 错误: "Permission denied"

**原因**: 权限不足
**解决**:
1. 登录OKX → API管理
2. 点击你的API Key
3. 确保勾选了"读取"权限
4. 保存

### 错误: "timeout"

**原因**: 网络问题
**解决**:
```bash
# 测试网络连通性
ping www.okx.com
```

---

## 📊 测试输出解读

### 成功输出示例

```
📊 账户余额详情:
  💰 总资产: 100.00000000 USDT      ← 账户总价值
  🟢 可用余额: 95.00000000 USDT    ← 可用于交易
  🔴 已用余额: 5.00000000 USDT     ← 已冻结资金
```

### 关键指标说明

- **总资产**: 账户所有资金（现货+合约+期权）
- **可用余额**: 可以用于下单的资金
- **已用余额**: 被占用/冻结的资金

---

## 🔧 高级使用

### 测试单个接口

```bash
# 只测试余额
go run test_okx_api.go
```

### 调试模式

测试工具会在出错时显示详细错误信息，包括HTTP状态码和OKX错误码。

### 重置配置

如果需要重置API凭证:

```bash
# 方法1: 编辑.env.local
vim .env.local

# 方法2: 删除.env.local并重新创建
rm .env.local
# 然后重新编辑
```

---

## ⚠️ 安全提醒

1. **永远不要**在Git中提交 `.env.local` 文件
2. **不要**将API凭证分享给他人
3. **定期**检查API使用情况
4. **启用**IP白名单限制
5. **删除**不需要的API凭证

---

## 📞 需要帮助?

- OKX官方文档: https://www.okx.com/docs-v5/en/
- API状态页面: https://www.okx.com/docs-v5/en/#rest-api-status
- 技术支持: OKX在线客服

---

## ✅ 验证清单

完成以下步骤后，你的OKX API就可以正常工作了:

- [ ] 创建了OKX API凭证
- [ ] 设置了正确的权限（读取+交易）
- [ ] 更新了.env.local文件
- [ ] 运行了测试工具
- [ ] 所有4个测试项都通过
- [ ] 余额数据正确显示

---

🎉 **恭喜！你已经成功配置了OKX API！**

现在可以返回测试Vercel云服务器上的应用，看看余额是否能正确显示了。
