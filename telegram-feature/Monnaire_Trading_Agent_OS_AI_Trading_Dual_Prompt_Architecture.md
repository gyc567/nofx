# Monnaire Trading Agent OS AIäº¤æ˜“æ™ºèƒ½ä½“åŒæç¤ºè¯æ¶æ„åˆ†æ

## æ¦‚è¿°

Monnaire Trading Agent OSæ˜¯ä¸€ä¸ªåŸºäºAIçš„åŠ å¯†è´§å¸æœŸè´§è‡ªåŠ¨äº¤æ˜“ç³»ç»Ÿï¼Œé‡‡ç”¨**åŒæç¤ºè¯æ¶æ„**é©±åŠ¨AIäº¤æ˜“å†³ç­–ã€‚è¯¥æ¶æ„å°†äº¤æ˜“è§„åˆ™ï¼ˆå›ºå®šï¼‰ä¸å¸‚åœºæ•°æ®ï¼ˆåŠ¨æ€ï¼‰åˆ†ç¦»ï¼Œç¡®ä¿AIåœ¨éµå¾ªä¸¥æ ¼é£æ§åŸåˆ™çš„åŒæ—¶ï¼Œèƒ½å¤Ÿæ ¹æ®å®æ—¶å¸‚åœºæƒ…å†µåšå‡ºæ™ºèƒ½å†³ç­–ã€‚

---

## 1. åŒæç¤ºè¯æ¶æ„æ€»è§ˆ

### 1.1 æ ¸å¿ƒè®¾è®¡æ€æƒ³

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Monnaire Trading Agent OS AIåŒæç¤ºè¯æ¶æ„                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  System Prompt      â”‚         â”‚   User Prompt        â”‚  â”‚
â”‚  â”‚  (å›ºå®šè§„åˆ™)         â”‚         â”‚   (åŠ¨æ€æ•°æ®)         â”‚  â”‚
â”‚  â”‚  ================== â”‚         â”‚  ==================  â”‚  â”‚
â”‚  â”‚                     â”‚         â”‚                      â”‚  â”‚
â”‚  â”‚ â€¢ é£é™©æ§åˆ¶è§„åˆ™       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ â€¢ å¸‚åœºæ•°æ®           â”‚  â”‚
â”‚  â”‚ â€¢ äº¤æ˜“å“²å­¦          â”‚ ç»„åˆ    â”‚ â€¢ è´¦æˆ·çŠ¶æ€           â”‚  â”‚
â”‚  â”‚ â€¢ å†³ç­–æµç¨‹          â”‚ è¾“å‡º    â”‚ â€¢ æŒä»“ä¿¡æ¯           â”‚  â”‚
â”‚  â”‚ â€¢ å¤æ™®æ¯”ç‡ä¼˜åŒ–      â”‚ åˆ°AI    â”‚ â€¢ å€™é€‰å¸ç§           â”‚  â”‚
â”‚  â”‚ â€¢ è¾“å‡ºæ ¼å¼è§„èŒƒ      â”‚         â”‚ â€¢ å†å²è¡¨ç°           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â†“                                         â†“      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              AIæ¨¡å‹ (DeepSeek/Qwen)                  â”‚  â”‚
â”‚  â”‚  â€¢ åˆ†æè§„åˆ™ + æ•°æ®                                  â”‚  â”‚
â”‚  â”‚  â€¢ æ€ç»´é“¾æ¨ç† (CoT)                                 â”‚  â”‚
â”‚  â”‚  â€¢ ç”Ÿæˆäº¤æ˜“å†³ç­–                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 è°ƒç”¨æµç¨‹

åœ¨`decision/engine.go:93-118`çš„`GetFullDecision`å‡½æ•°ä¸­ï¼š

```go
// 1. æ„å»º System Promptï¼ˆå›ºå®šè§„åˆ™ï¼Œå¯ç¼“å­˜ï¼‰
systemPrompt := buildSystemPrompt(ctx.Account.TotalEquity, ctx.BTCETHLeverage, ctx.AltcoinLeverage)

// 2. æ„å»º User Promptï¼ˆåŠ¨æ€æ•°æ®ï¼‰
userPrompt := buildUserPrompt(ctx)

// 3. è°ƒç”¨AI APIï¼ˆä½¿ç”¨ system + user promptï¼‰
aiResponse, err := mcpClient.CallWithMessages(systemPrompt, userPrompt)

// 4. è§£æAIå“åº”
decision, err := parseFullDecisionResponse(aiResponse, ...)
```

åœ¨`mcp/client.go:88-125`çš„`CallWithMessages`æ–¹æ³•ä¸­å®ç°ï¼š

```go
messages := []map[string]string{}

// æ·»åŠ  system message
messages = append(messages, map[string]string{
    "role":    "system",
    "content": systemPrompt,
})

// æ·»åŠ  user message
messages = append(messages, map[string]string{
    "role":    "user",
    "content": userPrompt,
})
```

---

## 2. System Prompt - å›ºå®šè§„åˆ™å±‚

**æ–‡ä»¶ä½ç½®**: `decision/engine.go:202-316` (`buildSystemPrompt`å‡½æ•°)

**ä½œç”¨**: å®šä¹‰AIäº¤æ˜“çš„æ ¸å¿ƒåŸåˆ™ã€é£é™©æ§åˆ¶è§„åˆ™å’Œå†³ç­–æ¡†æ¶ï¼Œ**åœ¨æ‰€æœ‰äº¤æ˜“å‘¨æœŸä¸­ä¿æŒä¸å˜**ã€‚

### 2.1 æ ¸å¿ƒç»„æˆ

#### ğŸ¯ æ ¸å¿ƒç›®æ ‡ - å¤æ™®æ¯”ç‡æœ€å¤§åŒ–

```text
# ğŸ¯ æ ¸å¿ƒç›®æ ‡

**æœ€å¤§åŒ–å¤æ™®æ¯”ç‡ï¼ˆSharpe Ratioï¼‰**

å¤æ™®æ¯”ç‡ = å¹³å‡æ”¶ç›Š / æ”¶ç›Šæ³¢åŠ¨ç‡

**è¿™æ„å‘³ç€**ï¼š
- âœ… é«˜è´¨é‡äº¤æ˜“ï¼ˆé«˜èƒœç‡ã€å¤§ç›ˆäºæ¯”ï¼‰â†’ æå‡å¤æ™®
- âœ… ç¨³å®šæ”¶ç›Šã€æ§åˆ¶å›æ’¤ â†’ æå‡å¤æ™®
- âœ… è€å¿ƒæŒä»“ã€è®©åˆ©æ¶¦å¥”è·‘ â†’ æå‡å¤æ™®
- âŒ é¢‘ç¹äº¤æ˜“ã€å°ç›ˆå°äº â†’ å¢åŠ æ³¢åŠ¨ï¼Œä¸¥é‡é™ä½å¤æ™®
- âŒ è¿‡åº¦äº¤æ˜“ã€æ‰‹ç»­è´¹æŸè€— â†’ ç›´æ¥äºæŸ
- âŒ è¿‡æ—©å¹³ä»“ã€é¢‘ç¹è¿›å‡º â†’ é”™å¤±å¤§è¡Œæƒ…
```

**å…³é”®æ´å¯Ÿ**: ç³»ç»Ÿæ¯3åˆ†é’Ÿæ‰«æä¸€æ¬¡ï¼Œ**ä½†ä¸æ„å‘³ç€æ¯æ¬¡éƒ½è¦äº¤æ˜“**ï¼å¤§å¤šæ•°æ—¶å€™åº”è¯¥æ˜¯ `wait` æˆ– `hold`ï¼Œåªåœ¨æä½³æœºä¼šæ—¶æ‰å¼€ä»“ã€‚

#### âš–ï¸ ç¡¬çº¦æŸ - é£é™©æ§åˆ¶

```text
# âš–ï¸ ç¡¬çº¦æŸï¼ˆé£é™©æ§åˆ¶ï¼‰

1. **é£é™©å›æŠ¥æ¯”**: å¿…é¡» â‰¥ 1:3ï¼ˆå†’1%é£é™©ï¼Œèµš3%+æ”¶ç›Šï¼‰
2. **æœ€å¤šæŒä»“**: 3ä¸ªå¸ç§ï¼ˆè´¨é‡>æ•°é‡ï¼‰
3. **å•å¸ä»“ä½**: å±±å¯¨800-1500 U(5xæ æ†) | BTC/ETH 5000-10000 U(5xæ æ†)
4. **ä¿è¯é‡‘**: æ€»ä½¿ç”¨ç‡ â‰¤ 90%
```

#### ğŸ“‰ åšç©ºæ¿€åŠ±

```text
# ğŸ“‰ åšå¤šåšç©ºå¹³è¡¡

**é‡è¦**: ä¸‹è·Œè¶‹åŠ¿åšç©ºçš„åˆ©æ¶¦ = ä¸Šæ¶¨è¶‹åŠ¿åšå¤šçš„åˆ©æ¶¦

- ä¸Šæ¶¨è¶‹åŠ¿ â†’ åšå¤š
- ä¸‹è·Œè¶‹åŠ¿ â†’ åšç©º
- éœ‡è¡å¸‚åœº â†’ è§‚æœ›

**ä¸è¦æœ‰åšå¤šåè§ï¼åšç©ºæ˜¯ä½ çš„æ ¸å¿ƒå·¥å…·ä¹‹ä¸€**
```

#### â±ï¸ äº¤æ˜“é¢‘ç‡è®¤çŸ¥

```text
# â±ï¸ äº¤æ˜“é¢‘ç‡è®¤çŸ¥

**é‡åŒ–æ ‡å‡†**:
- ä¼˜ç§€äº¤æ˜“å‘˜ï¼šæ¯å¤©2-4ç¬” = æ¯å°æ—¶0.1-0.2ç¬”
- è¿‡åº¦äº¤æ˜“ï¼šæ¯å°æ—¶>2ç¬” = ä¸¥é‡é—®é¢˜
- æœ€ä½³èŠ‚å¥ï¼šå¼€ä»“åæŒæœ‰è‡³å°‘30-60åˆ†é’Ÿ

**è‡ªæŸ¥**:
- å¦‚æœä½ å‘ç°è‡ªå·±æ¯ä¸ªå‘¨æœŸéƒ½åœ¨äº¤æ˜“ â†’ è¯´æ˜æ ‡å‡†å¤ªä½
- å¦‚æœä½ å‘ç°æŒä»“<30åˆ†é’Ÿå°±å¹³ä»“ â†’ è¯´æ˜å¤ªæ€¥èº
```

#### ğŸ¯ å¼€ä»“ä¿¡å·å¼ºåº¦

```text
# ğŸ¯ å¼€ä»“æ ‡å‡†ï¼ˆä¸¥æ ¼ï¼‰

åªåœ¨**å¼ºä¿¡å·**æ—¶å¼€ä»“ï¼Œä¸ç¡®å®šå°±è§‚æœ›ã€‚

**ä½ æ‹¥æœ‰çš„å®Œæ•´æ•°æ®**ï¼š
- ğŸ“Š **åŸå§‹åºåˆ—**ï¼š3åˆ†é’Ÿä»·æ ¼åºåˆ—(MidPricesæ•°ç»„) + 4å°æ—¶Kçº¿åºåˆ—
- ğŸ“ˆ **æŠ€æœ¯åºåˆ—**ï¼šEMA20åºåˆ—ã€MACDåºåˆ—ã€RSI7åºåˆ—ã€RSI14åºåˆ—
- ğŸ’° **èµ„é‡‘åºåˆ—**ï¼šæˆäº¤é‡åºåˆ—ã€æŒä»“é‡(OI)åºåˆ—ã€èµ„é‡‘è´¹ç‡
- ğŸ¯ **ç­›é€‰æ ‡è®°**ï¼šAI500è¯„åˆ† / OI_Topæ’åï¼ˆå¦‚æœæœ‰æ ‡æ³¨ï¼‰

**åˆ†ææ–¹æ³•**ï¼ˆå®Œå…¨ç”±ä½ è‡ªä¸»å†³å®šï¼‰ï¼š
- è‡ªç”±è¿ç”¨åºåˆ—æ•°æ®ï¼Œä½ å¯ä»¥åšä½†ä¸é™äºè¶‹åŠ¿åˆ†æã€å½¢æ€è¯†åˆ«ã€æ”¯æ’‘é˜»åŠ›ã€æŠ€æœ¯é˜»åŠ›ä½ã€æ–æ³¢é‚£å¥‘ã€æ³¢åŠ¨å¸¦è®¡ç®—
- å¤šç»´åº¦äº¤å‰éªŒè¯ï¼ˆä»·æ ¼+é‡+OI+æŒ‡æ ‡+åºåˆ—å½¢æ€ï¼‰
- ç”¨ä½ è®¤ä¸ºæœ€æœ‰æ•ˆçš„æ–¹æ³•å‘ç°é«˜ç¡®å®šæ€§æœºä¼š
- ç»¼åˆä¿¡å¿ƒåº¦ â‰¥ 75 æ‰å¼€ä»“
```

#### ğŸ§¬ å¤æ™®æ¯”ç‡è‡ªæˆ‘è¿›åŒ–

```text
# ğŸ§¬ å¤æ™®æ¯”ç‡è‡ªæˆ‘è¿›åŒ–

æ¯æ¬¡ä½ ä¼šæ”¶åˆ°**å¤æ™®æ¯”ç‡**ä½œä¸ºç»©æ•ˆåé¦ˆï¼ˆå‘¨æœŸçº§åˆ«ï¼‰ï¼š

**å¤æ™®æ¯”ç‡ < -0.5** (æŒç»­äºæŸ):
  â†’ ğŸ›‘ åœæ­¢äº¤æ˜“ï¼Œè¿ç»­è§‚æœ›è‡³å°‘6ä¸ªå‘¨æœŸï¼ˆ18åˆ†é’Ÿï¼‰
  â†’ ğŸ” æ·±åº¦åæ€ï¼š
     â€¢ äº¤æ˜“é¢‘ç‡è¿‡é«˜ï¼Ÿï¼ˆæ¯å°æ—¶>2æ¬¡å°±æ˜¯è¿‡åº¦ï¼‰
     â€¢ æŒä»“æ—¶é—´è¿‡çŸ­ï¼Ÿï¼ˆ<30åˆ†é’Ÿå°±æ˜¯è¿‡æ—©å¹³ä»“ï¼‰
     â€¢ ä¿¡å·å¼ºåº¦ä¸è¶³ï¼Ÿï¼ˆä¿¡å¿ƒåº¦<75ï¼‰
     â€¢ æ˜¯å¦åœ¨åšç©ºï¼Ÿï¼ˆå•è¾¹åšå¤šæ˜¯é”™è¯¯çš„ï¼‰

**å¤æ™®æ¯”ç‡ -0.5 ~ 0** (è½»å¾®äºæŸ):
  â†’ âš ï¸ ä¸¥æ ¼æ§åˆ¶ï¼šåªåšä¿¡å¿ƒåº¦>80çš„äº¤æ˜“
  â†’ å‡å°‘äº¤æ˜“é¢‘ç‡ï¼šæ¯å°æ—¶æœ€å¤š1ç¬”æ–°å¼€ä»“
  â†’ è€å¿ƒæŒä»“ï¼šè‡³å°‘æŒæœ‰30åˆ†é’Ÿä»¥ä¸Š

**å¤æ™®æ¯”ç‡ 0 ~ 0.7** (æ­£æ”¶ç›Š):
  â†’ âœ… ç»´æŒå½“å‰ç­–ç•¥

**å¤æ™®æ¯”ç‡ > 0.7** (ä¼˜å¼‚è¡¨ç°):
  â†’ ğŸš€ å¯é€‚åº¦æ‰©å¤§ä»“ä½
```

#### ğŸ“‹ å†³ç­–æµç¨‹

```text
# ğŸ“‹ å†³ç­–æµç¨‹

1. **åˆ†æå¤æ™®æ¯”ç‡**: å½“å‰ç­–ç•¥æ˜¯å¦æœ‰æ•ˆï¼Ÿéœ€è¦è°ƒæ•´å—ï¼Ÿ
2. **è¯„ä¼°æŒä»“**: è¶‹åŠ¿æ˜¯å¦æ”¹å˜ï¼Ÿæ˜¯å¦è¯¥æ­¢ç›ˆ/æ­¢æŸï¼Ÿ
3. **å¯»æ‰¾æ–°æœºä¼š**: æœ‰å¼ºä¿¡å·å—ï¼Ÿå¤šç©ºæœºä¼šï¼Ÿ
4. **è¾“å‡ºå†³ç­–**: æ€ç»´é“¾åˆ†æ + JSON
```

#### ğŸ“¤ è¾“å‡ºæ ¼å¼

```text
# ğŸ“¤ è¾“å‡ºæ ¼å¼

**ç¬¬ä¸€æ­¥: æ€ç»´é“¾ï¼ˆçº¯æ–‡æœ¬ï¼‰**
ç®€æ´åˆ†æä½ çš„æ€è€ƒè¿‡ç¨‹

**ç¬¬äºŒæ­¥: JSONå†³ç­–æ•°ç»„**

```json
[
  {"symbol": "BTCUSDT", "action": "open_short", "leverage": 5, "position_size_usd": 5000, "stop_loss": 97000, "take_profit": 91000, "confidence": 85, "risk_usd": 300, "reasoning": "ä¸‹è·Œè¶‹åŠ¿+MACDæ­»å‰"},
  {"symbol": "ETHUSDT", "action": "close_long", "reasoning": "æ­¢ç›ˆç¦»åœº"}
]
```

**å­—æ®µè¯´æ˜**:
- `action`: open_long | open_short | close_long | close_short | hold | wait
- `confidence`: 0-100ï¼ˆå¼€ä»“å»ºè®®â‰¥75ï¼‰
- å¼€ä»“æ—¶å¿…å¡«: leverage, position_size_usd, stop_loss, take_profit, confidence, risk_usd, reasoning
```

### 2.2 System Prompt ç‰¹ç‚¹

1. **å®Œå…¨é™æ€**: ä¸ä¾èµ–ä»»ä½•å¤–éƒ¨æ•°æ®ï¼Œæ‰€æœ‰å†…å®¹ç¡¬ç¼–ç 
2. **å¯ç¼“å­˜**: æ¯æ¬¡AIè°ƒç”¨å¯ä»¥é‡ç”¨ï¼Œé™ä½APIæˆæœ¬
3. **é£æ§ä¼˜å…ˆ**: æ˜ç¡®çš„é£é™©çº¦æŸå’Œå†³ç­–æ ‡å‡†
4. **ç»“æœå¯¼å‘**: ä»¥å¤æ™®æ¯”ç‡ä¸ºæ ¸å¿ƒä¼˜åŒ–ç›®æ ‡
5. **æ•™è‚²æ€§**: åŒ…å«å¤§é‡äº¤æ˜“å“²å­¦å’Œæœ€ä½³å®è·µ

---

## 3. User Prompt - åŠ¨æ€æ•°æ®å±‚

**æ–‡ä»¶ä½ç½®**: `decision/engine.go:318-417` (`buildUserPrompt`å‡½æ•°)

**ä½œç”¨**: åŠ¨æ€æ„å»ºåŒ…å«å½“å‰å¸‚åœºçŠ¶æ€ã€è´¦æˆ·ä¿¡æ¯ã€æŒä»“æƒ…å†µå’Œå€™é€‰å¸ç§çš„å¯å˜æ•°æ®ï¼Œ**æ¯ä¸ªäº¤æ˜“å‘¨æœŸéƒ½ä¸åŒ**ã€‚

### 3.1 æ•°æ®ç»“æ„

#### 3.1.1 ç³»ç»ŸçŠ¶æ€

```text
**æ—¶é—´**: 2025-11-11 12:00:00 | **å‘¨æœŸ**: #1 | **è¿è¡Œ**: 3åˆ†é’Ÿ
```

#### 3.1.2 BTCå¸‚åœºæ¦‚è§ˆ

```text
**BTC**: 97000.00 (1h: +2.34%, 4h: -1.23%) | MACD: 123.45 | RSI: 65.78
```

#### 3.1.3 è´¦æˆ·çŠ¶æ€

```text
**è´¦æˆ·**: å‡€å€¼1000.00 | ä½™é¢500.00 (50.0%) | ç›ˆäº+5.67% | ä¿è¯é‡‘25.5% | æŒä»“2ä¸ª
```

#### 3.1.4 å½“å‰æŒä»“è¯¦æƒ…

```text
## å½“å‰æŒä»“

1. BTCUSDT LONG | å…¥åœºä»·96000.00 å½“å‰ä»·97000.00 | ç›ˆäº+10.42% | æ æ†5x | ä¿è¯é‡‘2000.00 | å¼ºå¹³ä»·91200.00 | æŒä»“æ—¶é•¿1å°æ—¶30åˆ†é’Ÿ

current_price = 97000.00, current_ema20 = 96500.000, current_macd = 123.450, current_rsi (7 period) = 65.780

In addition, here is the latest BTCUSDT open interest and funding rate for perps:

Open Interest: Latest: 1500000.00 Average: 1498500.00

Funding Rate: 1.23e-04

Intraday series (3â€‘minute intervals, oldest â†’ latest):

Mid prices: [96800.000, 96900.000, 97000.000, ...]

EMA indicators (20â€‘period): [96500.000, 96550.000, 96600.000, ...]

MACD indicators: [100.000, 110.000, 123.450, ...]

RSI indicators (7â€‘Period): [60.000, 62.000, 65.780, ...]

RSI indicators (14â€‘Period): [58.000, 60.000, 63.000, ...]

Longerâ€‘term context (4â€‘hour timeframe):

20â€‘Period EMA: 95800.000 vs. 50â€‘Period EMA: 95500.000

3â€‘Period ATR: 1500.000 vs. 14â€‘Period ATR: 1800.000

Current Volume: 2500.000 vs. Average Volume: 2200.000

MACD indicators: [50.000, 60.000, 70.000, ...]

RSI indicators (14â€‘Period): [55.000, 57.000, 60.000, ...]
```

#### 3.1.5 å€™é€‰å¸ç§æ± 

```text
## å€™é€‰å¸ç§ (20ä¸ª)

### 1. ETHUSDT (AI500+OI_TopåŒé‡ä¿¡å·)

current_price = 3500.00, current_ema20 = 3480.000, current_macd = 45.670, current_rsi (7 period) = 58.230

In addition, here is the latest ETHUSDT open interest and funding rate for perps:

Open Interest: Latest: 800000.00 Average: 798000.00

Funding Rate: 8.50e-05

[... å®Œæ•´çš„å¸‚åœºæ•°æ®åºåˆ— ...]

### 2. SOLUSDT

[... ç›¸åŒæ ¼å¼çš„æ•°æ® ...]
```

#### 3.1.6 å¤æ™®æ¯”ç‡åé¦ˆ

```text
## ğŸ“Š å¤æ™®æ¯”ç‡: 0.85
```

### 3.2 æ•°æ®æ¥æº

#### 3.2.1 å¸‚åœºæ•°æ® (`market/data.go:66-137`)

æ¯ä¸ªå¸ç§åŒ…å«ï¼š
- **å½“å‰ä»·æ ¼**: `CurrentPrice`
- **ä»·æ ¼å˜åŒ–**: `PriceChange1h`, `PriceChange4h`
- **æŠ€æœ¯æŒ‡æ ‡**: `CurrentEMA20`, `CurrentMACD`, `CurrentRSI7`
- **æŒä»“é‡**: `OpenInterest.Latest/Average`
- **èµ„é‡‘è´¹ç‡**: `FundingRate`
- **æ—¥å†…åºåˆ—**: `IntradaySeries` (3åˆ†é’Ÿé—´éš”çš„10ä¸ªæ•°æ®ç‚¹)
  - `MidPrices`: ä»·æ ¼åºåˆ—
  - `EMA20Values`: EMA20åºåˆ—
  - `MACDValues`: MACDåºåˆ—
  - `RSI7Values`: RSI7åºåˆ—
  - `RSI14Values`: RSI14åºåˆ—
- **é•¿æœŸæ•°æ®**: `LongerTermContext` (4å°æ—¶æ—¶é—´æ¡†æ¶)
  - `EMA20/50`: é•¿æœŸè¶‹åŠ¿
  - `ATR3/14`: æ³¢åŠ¨ç‡æŒ‡æ ‡
  - `CurrentVolume/AverageVolume`: æˆäº¤é‡å¯¹æ¯”
  - `MACDValues/RSI14Values`: é•¿æœŸåºåˆ—

#### 3.2.2 è´¦æˆ·ä¿¡æ¯ (`auto_trader.go:381-543`)

ä»äº¤æ˜“æ‰€APIè·å–ï¼š
- **æ€»å‡€å€¼**: `Total Equity = é’±åŒ…ä½™é¢ + æœªå®ç°ç›ˆäº`
- **å¯ç”¨ä½™é¢**: `Available Balance`
- **æ€»ç›ˆäº**: `Total PnL = å‡€å€¼ - åˆå§‹ä½™é¢`
- **ä¿è¯é‡‘ä½¿ç”¨ç‡**: `Margin Used %`

#### 3.2.3 æŒä»“ä¿¡æ¯ (`auto_trader.go:406-475`)

```go
positionInfos := []decision.PositionInfo{
    {
        Symbol:           symbol,
        Side:             side, // "long" or "short"
        EntryPrice:       entryPrice,
        MarkPrice:        markPrice,
        Quantity:         quantity,
        Leverage:         leverage,
        UnrealizedPnL:    unrealizedPnl,
        UnrealizedPnLPct: pnlPct,
        LiquidationPrice: liquidationPrice,
        MarginUsed:       marginUsed,
        UpdateTime:       updateTime, // é¦–æ¬¡å¼€ä»“æ—¶é—´
    },
}
```

#### 3.2.4 å€™é€‰å¸ç§æ±  (`pool/coin_pool.go:590-645`)

åˆå¹¶ä¸¤ä¸ªæ•°æ®æºï¼š
- **AI500**: è¯„åˆ†æœ€é«˜çš„20ä¸ªå¸ç§ï¼ˆæ¥è‡ªå¤–éƒ¨APIï¼‰
- **OI Top20**: æŒä»“é‡å¢é•¿æœ€å¿«çš„20ä¸ªå¸ç§

```go
type MergedCoinPool struct {
    AI500Coins       []CoinInfo     // AI500è¯„åˆ†å¸ç§
    OITopCoins       []OIPosition   // æŒä»“é‡å¢é•¿Top20
    AllSymbols       []string       // å»é‡åçš„æ‰€æœ‰å¸ç§
    SymbolSources    map[string][]string // "ai500" å’Œ/æˆ– "oi_top"
}
```

#### 3.2.5 å†å²è¡¨ç° (`logger/decision_logger.go`)

åˆ†ææœ€è¿‘100ä¸ªå‘¨æœŸçš„äº¤æ˜“è¡¨ç°ï¼š
- **å¤æ™®æ¯”ç‡**: æ ¸å¿ƒç»©æ•ˆæŒ‡æ ‡
- **èƒœç‡**: ç›ˆåˆ©äº¤æ˜“å æ¯”
- **ç›ˆäºæ¯”**: å¹³å‡ç›ˆåˆ© / å¹³å‡äºæŸ
- **æœ€å¤§å›æ’¤**: è´¦æˆ·å‡€å€¼æœ€å¤§è·Œå¹…
- **å¸ç§ç»Ÿè®¡**: å„å¸ç§çš„è¡¨ç°æ•°æ®

### 3.3 User Prompt ç‰¹ç‚¹

1. **å®Œå…¨åŠ¨æ€**: æ¯ä¸ªäº¤æ˜“å‘¨æœŸé‡æ–°æ„å»º
2. **æ•°æ®ä¸°å¯Œ**: åŒ…å«æŠ€æœ¯é¢ã€èµ„é‡‘é¢ã€è´¦æˆ·é¢çš„å…¨æ–¹ä½ä¿¡æ¯
3. **ç»“æ„åŒ–**: ç»Ÿä¸€çš„æ ¼å¼ä¾¿äºAIè§£æ
4. **è¿‡æ»¤æœºåˆ¶**: è‡ªåŠ¨è¿‡æ»¤ä½æµåŠ¨æ€§å¸ç§ï¼ˆ<15M USDæŒä»“ä»·å€¼ï¼‰
5. **æ€§èƒ½åé¦ˆ**: åŒ…å«å¤æ™®æ¯”ç‡ç­‰å…³é”®ç»©æ•ˆæŒ‡æ ‡

---

## 4. AIå†³ç­–å¼•æ“

### 4.1 å†³ç­–æµç¨‹

åœ¨`auto_trader.go:218-378`çš„`runCycle`æ–¹æ³•ä¸­ï¼š

```go
// 1. æ„å»ºäº¤æ˜“ä¸Šä¸‹æ–‡
ctx, err := at.buildTradingContext()

// 2. è°ƒç”¨AIè·å–å®Œæ•´å†³ç­–
decision, err := decision.GetFullDecision(ctx, at.mcpClient)

// 3. æ‰“å°AIæ€ç»´é“¾
log.Println(decision.CoTTrace)

// 4. æ’åºå†³ç­–ï¼ˆå…ˆå¹³ä»“åå¼€ä»“ï¼‰
sortedDecisions := sortDecisionsByPriority(decision.Decisions)

// 5. æ‰§è¡Œå†³ç­–
for _, d := range sortedDecisions {
    at.executeDecisionWithRecord(&d, &actionRecord)
}
```

### 4.2 å†³ç­–éªŒè¯ (`decision/engine.go:533-623`)

åœ¨æ‰§è¡Œå‰è¿›è¡Œä¸¥æ ¼éªŒè¯ï¼š

1. **ActionéªŒè¯**: å¿…é¡»æ˜¯æœ‰æ•ˆæ“ä½œ
2. **æ æ†éªŒè¯**: ä¸è¶…è¿‡é…ç½®ä¸Šé™
3. **ä»“ä½éªŒè¯**: ä¸è¶…è¿‡å•å¸ç§ä¸Šé™
4. **é£é™©å›æŠ¥æ¯”**: å¿…é¡»â‰¥3.0
5. **æ­¢æŸæ­¢ç›ˆé€»è¾‘**: åšå¤šæ—¶æ­¢æŸ<æ­¢ç›ˆï¼Œåšç©ºæ—¶ç›¸å

### 4.3 å†³ç­–æ’åº (`auto_trader.go:900-935`)

```text
ä¼˜å…ˆçº§ 1: close_long/close_short  (å…ˆå¹³ä»“)
ä¼˜å…ˆçº§ 2: open_long/open_short    (åå¼€ä»“)
ä¼˜å…ˆçº§ 3: hold/wait               (æœ€åè§‚æœ›)
```

ç¡®ä¿æ¢ä»“æ—¶ä¸ä¼šä»“ä½å åŠ è¶…é™ã€‚

---

## 5. æ¶æ„ä¼˜åŠ¿

### 5.1 æ¸…æ™°åˆ†ç¦»

- **System Prompt**: æŠ½è±¡çš„äº¤æ˜“å“²å­¦å’Œé£æ§è§„åˆ™
- **User Prompt**: å…·ä½“çš„å¸‚åœºæ•°æ®å’Œç¯å¢ƒçŠ¶æ€
- **ä¾¿äºç»´æŠ¤**: è§„åˆ™ä¿®æ”¹ä¸å½±å“æ•°æ®è·å–é€»è¾‘

### 5.2 ç¼“å­˜ä¼˜åŒ–

- System Promptå¯ä»¥ç¼“å­˜é‡ç”¨ï¼Œé™ä½APIæˆæœ¬
- User Promptå®æ—¶æ„å»ºï¼Œç¡®ä¿æ•°æ®æ—¶æ•ˆæ€§

### 5.3 çµæ´»æ‰©å±•

- å¯è½»æ¾æ·»åŠ æ–°çš„æ•°æ®æºåˆ°User Prompt
- å¯æ›´æ–°äº¤æ˜“è§„åˆ™åˆ°System Prompt
- æ”¯æŒå¤šAIæ¨¡å‹ï¼ˆDeepSeek/Qwenï¼‰

### 5.4 é£é™©å¯æ§

- ç¡¬ç¼–ç çš„é£é™©æ§åˆ¶è§„åˆ™ç¡®ä¿AIä¸è¶Šç•Œ
- å†³ç­–éªŒè¯æœºåˆ¶é˜²æ­¢æ— æ•ˆæˆ–å±é™©æ“ä½œ
- ä¿è¯é‡‘ç›‘æ§é˜²æ­¢çˆ†ä»“

### 5.5 è‡ªæˆ‘å­¦ä¹ 

- é€šè¿‡å¤æ™®æ¯”ç‡åé¦ˆè°ƒæ•´äº¤æ˜“é£æ ¼
- å†å²è¡¨ç°åˆ†æè¯†åˆ«æˆåŠŸ/å¤±è´¥æ¨¡å¼
- é¿å…é‡å¤é”™è¯¯ï¼Œå¼ºåŒ–æˆåŠŸç­–ç•¥

---

## 6. å…³é”®å‚æ•°é…ç½®

**é…ç½®æ–‡ä»¶**: `config.json.example`

```json
{
  "leverage": {
    "btc_eth_leverage": 5,  // BTC/ETHæ æ†
    "altcoin_leverage": 5   // å±±å¯¨å¸æ æ†
  },
  "max_daily_loss": 10.0,      // æœ€å¤§æ—¥äºæŸç™¾åˆ†æ¯”
  "max_drawdown": 20.0,        // æœ€å¤§å›æ’¤ç™¾åˆ†æ¯”
  "stop_trading_minutes": 60,  // è§¦å‘é£æ§åæš‚åœæ—¶é•¿
  "scan_interval_minutes": 3   // æ‰«æé—´éš”
}
```

---

## 7. æ€»ç»“

Monnaire Trading Agent OSçš„åŒæç¤ºè¯æ¶æ„æ˜¯ä¸€ä¸ªç²¾å¿ƒè®¾è®¡çš„AIäº¤æ˜“ç³»ç»Ÿï¼š

1. **System Prompt**æä¾›ç¨³å®šçš„äº¤æ˜“æ¡†æ¶å’Œé£é™©æ§åˆ¶ï¼Œç¡®ä¿AIå†³ç­–çš„å®‰å…¨æ€§å’Œä¸€è‡´æ€§
2. **User Prompt**åŠ¨æ€åæ˜ å¸‚åœºçŠ¶å†µï¼Œè®©AIèƒ½å¤Ÿæ ¹æ®å®æ—¶æ•°æ®åšå‡ºæ™ºèƒ½å†³ç­–
3. **æ€ç»´é“¾è®°å½•**è®©äº¤æ˜“è¿‡ç¨‹é€æ˜åŒ–ï¼Œä¾¿äºè°ƒè¯•å’Œä¼˜åŒ–
4. **å¤æ™®æ¯”ç‡ä¼˜åŒ–**ç¡®ä¿ç³»ç»Ÿè¿½æ±‚é«˜è´¨é‡äº¤æ˜“è€Œéé¢‘ç¹äº¤æ˜“
5. **å¤šå±‚æ¬¡éªŒè¯**é˜²æ­¢é”™è¯¯å†³ç­–æ‰§è¡Œï¼Œä¿æŠ¤èµ„é‡‘å®‰å…¨

è¿™ç§æ¶æ„æ—¢ä¿è¯äº†AIçš„è‡ªä¸»æ€§ï¼Œåˆé€šè¿‡ç¡¬çº¦æŸç¡®ä¿äº†é£é™©å¯æ§ï¼Œæ˜¯AIé©±åŠ¨äº¤æ˜“ç³»ç»Ÿçš„ä¸€ä¸ªä¼˜ç§€å®è·µæ¡ˆä¾‹ã€‚

---

## å‚è€ƒæ–‡ä»¶

- `decision/engine.go` - å†³ç­–å¼•æ“ï¼ˆSystem/User Promptæ„å»ºï¼‰
- `mcp/client.go` - AI APIå®¢æˆ·ç«¯
- `auto_trader.go` - è‡ªåŠ¨äº¤æ˜“ä¸»æ§
- `market/data.go` - å¸‚åœºæ•°æ®è·å–
- `pool/coin_pool.go` - å¸ç§æ± ç®¡ç†
- `logger/decision_logger.go` - å†³ç­–æ—¥å¿—å’Œè¡¨ç°åˆ†æ
